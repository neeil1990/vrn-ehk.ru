{"version":3,"file":"user-consent.bundle.js","sources":["../src/user-consent.js"],"sourcesContent":["import { BitrixVue } from 'ui.vue';\nimport { ajax, Tag, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events'\nimport { EventType, Component, RestMethod } from 'sale.checkout.const';\n\n\nBitrixVue.component('sale-checkout-view-user_consent', {\n\tprops: ['item'],\n\tmethods:\n\t{\n\t\tgetBlockHtml()\n\t\t{\n\t\t\tlet userConsent = {\n\t\t\t\tid: this.item.id,\n\t\t\t\ttitle: this.item.title,\n\t\t\t\tisLoaded: this.item.isLoaded,\n\t\t\t\tautoSave: this.item.autoSave,\n\t\t\t\tisChecked: this.item.isChecked,\n\t\t\t\tsubmitEventName: this.item.submitEventName,\n\t\t\t\tfields: this.item.params\n\t\t\t};\n\n\t\t\tajax.runComponentAction(\n\t\t\t\tComponent.bitrixSaleOrderCheckout,\n\t\t\t\tRestMethod.saleEntityUserConsentRequest,\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfields: userConsent\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((response)=>{\n\t\t\t\t\t\tif(\n\t\t\t\t\t\t\tBX.type.isPlainObject(response.data)\n\t\t\t\t\t\t\t&& BX.type.isNotEmptyString(response.data.html)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet consent = response.data.html;\n\n\t\t\t\t\t\t\tif (BX.UserConsent !== undefined)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlet wrapper = this.$refs.consentDiv;\n\n\t\t\t\t\t\t\t\twrapper.appendChild(Tag.render`<div>${consent}</div>`);\n\n\t\t\t\t\t\t\t\tlet control = BX.UserConsent.load(wrapper);\n\n\n\t\t\t\t\t\t\t\tBX.addCustomEvent(\n\t\t\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\t\t\tBX.UserConsent.events.accepted,\n\t\t\t\t\t\t\t\t\t() => EventEmitter.emit(EventType.consent.accepted, {})\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tBX.addCustomEvent(\n\t\t\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\t\t\tBX.UserConsent.events.refused,\n\t\t\t\t\t\t\t\t\t() => EventEmitter.emit(EventType.consent.refused, {})\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t})\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tthis.getBlockHtml();\n\t},\n\t// language=Vue\n\ttemplate: `\n\t  <div class=\"checkout-basket-section checkout-basket-section-consent\">\n\t\t<div ref=\"consentDiv\"/>\n      </div>\n\t`\n});"],"names":["BitrixVue","component","props","methods","getBlockHtml","userConsent","id","item","title","isLoaded","autoSave","isChecked","submitEventName","fields","params","ajax","runComponentAction","Component","bitrixSaleOrderCheckout","RestMethod","saleEntityUserConsentRequest","data","then","response","BX","type","isPlainObject","isNotEmptyString","html","consent","UserConsent","undefined","wrapper","$refs","consentDiv","appendChild","Tag","render","control","load","addCustomEvent","events","accepted","EventEmitter","emit","EventType","refused","mounted","template"],"mappings":";;;;;;;AAAA,AAMAA,iBAAS,CAACC,SAAS,CAAC,iCAAiC,EAAE;GACtDC,KAAK,EAAE,CAAC,MAAM,CAAC;GACfC,OAAO,EACP;KACCC,YAAY,0BACZ;OAAA;OACC,IAAIC,WAAW,GAAG;SACjBC,EAAE,EAAE,IAAI,CAACC,IAAI,CAACD,EAAE;SAChBE,KAAK,EAAE,IAAI,CAACD,IAAI,CAACC,KAAK;SACtBC,QAAQ,EAAE,IAAI,CAACF,IAAI,CAACE,QAAQ;SAC5BC,QAAQ,EAAE,IAAI,CAACH,IAAI,CAACG,QAAQ;SAC5BC,SAAS,EAAE,IAAI,CAACJ,IAAI,CAACI,SAAS;SAC9BC,eAAe,EAAE,IAAI,CAACL,IAAI,CAACK,eAAe;SAC1CC,MAAM,EAAE,IAAI,CAACN,IAAI,CAACO;QAClB;OAEDC,cAAI,CAACC,kBAAkB,CACtBC,6BAAS,CAACC,uBAAuB,EACjCC,8BAAU,CAACC,4BAA4B,EACvC;SACCC,IAAI,EAAE;WACLR,MAAM,EAAER;;QAET,CACD,CACCiB,IAAI,CAAC,UAACC,QAAQ,EAAG;SAChB,IACCC,EAAE,CAACC,IAAI,CAACC,aAAa,CAACH,QAAQ,CAACF,IAAI,CAAC,IACjCG,EAAE,CAACC,IAAI,CAACE,gBAAgB,CAACJ,QAAQ,CAACF,IAAI,CAACO,IAAI,CAAC,EAEhD;WACC,IAAIC,OAAO,GAAGN,QAAQ,CAACF,IAAI,CAACO,IAAI;WAEhC,IAAIJ,EAAE,CAACM,WAAW,KAAKC,SAAS,EAChC;aACC,IAAIC,OAAO,GAAG,KAAI,CAACC,KAAK,CAACC,UAAU;aAEnCF,OAAO,CAACG,WAAW,CAACC,aAAG,CAACC,MAAM,iGAAQR,OAAO,EAAS;aAEtD,IAAIS,OAAO,GAAGd,EAAE,CAACM,WAAW,CAACS,IAAI,CAACP,OAAO,CAAC;aAG1CR,EAAE,CAACgB,cAAc,CAChBF,OAAO,EACPd,EAAE,CAACM,WAAW,CAACW,MAAM,CAACC,QAAQ,EAC9B;eAAA,OAAMC,6BAAY,CAACC,IAAI,CAACC,6BAAS,CAAChB,OAAO,CAACa,QAAQ,EAAE,EAAE,CAAC;eACvD;aACDlB,EAAE,CAACgB,cAAc,CAChBF,OAAO,EACPd,EAAE,CAACM,WAAW,CAACW,MAAM,CAACK,OAAO,EAC7B;eAAA,OAAMH,6BAAY,CAACC,IAAI,CAACC,6BAAS,CAAChB,OAAO,CAACiB,OAAO,EAAE,EAAE,CAAC;eACtD;;;QAGJ,CAAC;;IAEJ;GACDC,OAAO,qBACP;KACC,IAAI,CAAC3C,YAAY,EAAE;IACnB;;GAED4C,QAAQ;CAKT,CAAC,CAAC;;;;"}