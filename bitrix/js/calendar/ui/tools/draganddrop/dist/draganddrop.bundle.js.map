{"version":3,"file":"draganddrop.bundle.js","sources":["../src/draganddropinterface.js","../src/eventdraganddrop.js","../src/resizedraganddrop.js"],"sourcesContent":["/**\n * @interface\n */\nexport default class DragAndDropInterface\n{\n\tonDragStart() {}\n\n\tgetDragBoundary() {}\n\n\tgetFinalFrom() {}\n\n\tgetFinalTo() {}\n}\n","import DragAndDropInterface from './draganddropinterface';\n\n/**\n * @implements DragAndDropInterface\n */\nexport class EventDragAndDrop implements DragAndDropInterface\n{\n\tmaxTryDuration = 50;\n\t// stickDistanceInMinutes = 30;\n\tstickDistanceInPercents = 34;\n\tmagnetizeDistanceInMinutes = 15;\n\n\tconstructor(getDateByPos, getPosByDate, getEvents)\n\t{\n\t\tthis.getDateByPos = getDateByPos;\n\t\tthis.getPosByDate = getPosByDate;\n\t\tthis.getEvents = getEvents;\n\t}\n\n\tgetFinalFrom()\n\t{\n\t\treturn this.finalFrom;\n\t}\n\n\tgetFinalTo()\n\t{\n\t\treturn this.finalTo;\n\t}\n\n\tonDragStart(duration, startPosition = 0)\n\t{\n\t\tthis.savedDuration = duration;\n\t\tthis.tryDuration = 0;\n\t\tconst startBoundary = this.getBoundaryFromPosition(startPosition);\n\t\tthis.finalFrom = startBoundary.from;\n\t\tthis.finalTo = startBoundary.to;\n\t}\n\n\tgetDragBoundary(position)\n\t{\n\t\tconst diff = this.previousPosition ? this.previousPosition - position : 0;\n\t\tthis.previousPosition = position;\n\t\tthis.calculateTryDuration(diff);\n\t\tthis.resetMagnetStamps(diff);\n\n\t\tlet boundary = this.getBoundaryFromPosition(position);\n\t\tif (this.doMagnetize())\n\t\t{\n\t\t\tboundary = this.getMagnetizedBoundary(boundary, diff);\n\t\t}\n\t\tboundary.size = this.getPosByDate(boundary.to) - this.getPosByDate(boundary.from);\n\n\t\tthis.finalFrom = boundary.from;\n\t\tthis.finalTo = boundary.to;\n\t\treturn boundary;\n\t}\n\n\tgetBoundaryFromPosition(position)\n\t{\n\t\tconst from = this.getDateByPos(position);\n\t\tconst to = from ? new Date(from.getTime() + this.savedDuration) : null;\n\t\treturn { from, to, position, wasMagnetized: false };\n\t}\n\n\tgetMagnetizedBoundary(boundary, diff)\n\t{\n\t\tlet position = boundary.position;\n\t\tlet duration = this.savedDuration;\n\n\t\tconst magnetizedTimeInterval = this.getMagnetizedTimeInterval(boundary.from, boundary.to);\n\t\tconst magnetizedFromPosition = this.getPosByDate(magnetizedTimeInterval.from);\n\t\tconst wasMagnetized = magnetizedTimeInterval.wasMagnetizedTo || magnetizedTimeInterval.wasMagnetizedFrom;\n\t\tif (wasMagnetized)\n\t\t{\n\t\t\tposition = magnetizedFromPosition;\n\t\t\tduration = magnetizedTimeInterval.to.getTime() - magnetizedTimeInterval.from.getTime();\n\t\t}\n\n\t\t// stabilize magnets\n\t\tif (!this.endMagnetStamp && boundary.to.getTime() < magnetizedTimeInterval.to.getTime() && diff < 0)\n\t\t{\n\t\t\tthis.endMagnetStamp = position;\n\t\t}\n\t\tif (this.endMagnetStamp)\n\t\t{\n\t\t\tif (this.endMagnetStamp + 5 < position)\n\t\t\t{\n\t\t\t\tthis.endMagnetStamp = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tposition = this.endMagnetStamp;\n\t\t\t}\n\t\t}\n\t\tif (!this.startMagnetStamp && boundary.from.getTime() > magnetizedTimeInterval.from.getTime() && diff > 0)\n\t\t{\n\t\t\tthis.startMagnetStamp = position;\n\t\t}\n\t\tif (this.startMagnetStamp)\n\t\t{\n\t\t\tif (magnetizedFromPosition < this.startMagnetStamp)\n\t\t\t{\n\t\t\t\tthis.startMagnetStamp = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tposition = this.startMagnetStamp;\n\t\t\t}\n\t\t}\n\n\t\tconst from = this.getDateByPos(position);\n\t\tconst to = new Date(from.getTime() + duration);\n\t\treturn { from, to, position, wasMagnetized };\n\t}\n\n\t/**\n\t * stick - behavior when dragged event intersects with another event\n\t * and we push dragged event to top or to bottom of another event\n\t *\n\t * magnetize - behavior when dragged event is close to another event\n\t * and we move it closer to another event\n\t */\n\tgetMagnetizedTimeInterval(fromDate, toDate)\n\t{\n\t\tlet wasMagnetizedFrom = false;\n\t\tlet wasMagnetizedTo = false;\n\t\tlet from = new Date(fromDate.getTime());\n\t\tlet to = new Date(toDate.getTime());\n\t\tconst duration = to.getTime() - from.getTime();\n\t\tconst magnetDistance = this.magnetizeDistanceInMinutes * 60 * 1000;\n\t\tconst stickDistance = (this.stickDistanceInPercents / 100) * this.savedDuration;\n\n\t\t// find lowest fromDate and highest toDate\n\t\tlet fromDateMax = new Date(from.getTime());\n\t\tfromDateMax.setHours(0, 0, 0, 0);\n\t\tlet toDateMin = new Date(to.getTime());\n\t\ttoDateMin.setHours(23, 59, 0, 0);\n\n\t\tconst events = this.getEvents();\n\t\tfor (const event of events)\n\t\t{\n\t\t\tconst eventFrom = event.from.getTime();\n\t\t\tconst eventTo = event.to.getTime();\n\n\t\t\tif (eventTo > fromDateMax.getTime() && eventTo <= to.getTime())\n\t\t\t{\n\t\t\t\tfromDateMax = new Date(eventTo);\n\t\t\t}\n\n\t\t\tif (eventFrom < toDateMin.getTime() && eventFrom >= from.getTime())\n\t\t\t{\n\t\t\t\ttoDateMin = new Date(eventFrom);\n\t\t\t}\n\t\t}\n\n\t\t// if too many events\n\t\tif (fromDateMax.getTime() >= toDateMin.getTime())\n\t\t{\n\t\t\treturn { from, to, wasMagnetizedFrom, wasMagnetizedTo };\n\t\t}\n\n\t\t// stick\n\t\tif (fromDateMax.getTime() > from.getTime() && (fromDateMax.getTime() - from.getTime() <= stickDistance))\n\t\t{\n\t\t\tfrom = new Date(fromDateMax.getTime());\n\t\t\tto = new Date(from.getTime() + duration);\n\t\t\twasMagnetizedFrom = true;\n\t\t}\n\t\tif (toDateMin.getTime() < to.getTime() && (to.getTime() - toDateMin.getTime() <= stickDistance))\n\t\t{\n\t\t\tto = new Date(toDateMin.getTime());\n\t\t\tfrom = new Date(to.getTime() - duration);\n\t\t\twasMagnetizedTo = true;\n\t\t}\n\t\tif (fromDateMax.getTime() > from.getTime() && (fromDateMax.getTime() - from.getTime() <= stickDistance))\n\t\t{\n\t\t\tfrom = new Date(fromDateMax.getTime());\n\t\t\tto = new Date(from.getTime() + duration);\n\t\t\twasMagnetizedFrom = true;\n\t\t}\n\t\tif (wasMagnetizedFrom && wasMagnetizedTo)\n\t\t{\n\t\t\tfrom = new Date(fromDateMax.getTime());\n\t\t\tto = new Date(toDateMin.getTime());\n\t\t}\n\n\t\t// magnetize\n\t\tif (!wasMagnetizedFrom && !wasMagnetizedTo)\n\t\t{\n\t\t\tif (from.getTime() > fromDateMax.getTime() && (from.getTime() - fromDateMax.getTime() <= magnetDistance))\n\t\t\t{\n\t\t\t\twasMagnetizedFrom = true;\n\t\t\t}\n\t\t\tif (toDateMin.getTime() > to.getTime() && (toDateMin.getTime() - to.getTime() <= magnetDistance))\n\t\t\t{\n\t\t\t\twasMagnetizedTo = true;\n\t\t\t}\n\t\t\tif (wasMagnetizedFrom && !wasMagnetizedTo)\n\t\t\t{\n\t\t\t\tfrom = new Date(fromDateMax.getTime());\n\t\t\t\tto = new Date(from.getTime() + duration);\n\t\t\t}\n\t\t\tif (wasMagnetizedTo && !wasMagnetizedFrom)\n\t\t\t{\n\t\t\t\tto = new Date(toDateMin.getTime());\n\t\t\t\tfrom = new Date(to.getTime() - duration);\n\t\t\t}\n\t\t}\n\n\t\treturn { from, to, wasMagnetizedFrom, wasMagnetizedTo };\n\t}\n\n\tresetMagnetStamps(diff)\n\t{\n\t\tif (diff > 0)\n\t\t{\n\t\t\tthis.endMagnetStamp = null;\n\t\t}\n\t\tif (diff < 0)\n\t\t{\n\t\t\tthis.startMagnetStamp = null;\n\t\t}\n\t}\n\n\tcalculateTryDuration(diff)\n\t{\n\t\tif (Math.abs(diff) < 1)\n\t\t{\n\t\t\tthis.tryDuration++;\n\t\t}\n\t\tif (Math.abs(diff) > 3)\n\t\t{\n\t\t\tthis.tryDuration = 0;\n\t\t}\n\t}\n\n\tdoMagnetize()\n\t{\n\t\treturn !this.isAnyModifierKeyPressed() && !this.isUserTryingToTurnOffMagnet();\n\t}\n\n\tisUserTryingToTurnOffMagnet()\n\t{\n\t\treturn this.tryDuration > this.maxTryDuration;\n\t}\n\n\tisAnyModifierKeyPressed()\n\t{\n\t\tif (window.event)\n\t\t{\n\t\t\treturn window.event.altKey || window.event.shiftKey || window.event.ctrlKey || window.event.metaKey;\n\t\t}\n\t\treturn true;\n\t}\n\n}\n","import DragAndDropInterface from './draganddropinterface';\n\n/**\n * @implements DragAndDropInterface\n */\nexport class ResizeDragAndDrop implements DragAndDropInterface\n{\n\n\tconstructor(getDateByPos, getPosByDate)\n\t{\n\t\tthis.getDateByPos = getDateByPos;\n\t\tthis.getPosByDate = getPosByDate;\n\t}\n\n\tgetFinalFrom()\n\t{\n\t\treturn this.from;\n\t}\n\n\tgetFinalTo()\n\t{\n\t\treturn this.to;\n\t}\n\n\tonDragStart(timeInterval, minSize = 0, isStartResizer = false)\n\t{\n\t\tthis.from = timeInterval.from;\n\t\tthis.to = timeInterval.to;\n\t\tthis.isStartResizer = isStartResizer;\n\t\tthis.direction = isStartResizer ? -1 : 1;\n\n\t\tthis.positionStart = this.getPosByDate(this.from);\n\t\tthis.positionEnd = this.getPosByDate(this.to);\n\t\tthis.size = this.positionEnd - this.positionStart;\n\t\tthis.minSize = minSize;\n\t}\n\n\tgetDragBoundary(dy)\n\t{\n\t\tconst size = Math.max(this.size + dy * this.direction, this.minSize);\n\n\t\tif (this.isStartResizer)\n\t\t{\n\t\t\tthis.positionStart = this.positionEnd - size;\n\t\t\tconst timeFrom = this.getDateByPos(this.positionStart);\n\t\t\tthis.from.setHours(timeFrom.getHours(), timeFrom.getMinutes(), 0, 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.positionEnd = this.positionStart + size;\n\t\t\tconst timeTo = this.getDateByPos(this.positionEnd);\n\t\t\tthis.to.setHours(timeTo.getHours(), timeTo.getMinutes(), 0, 0);\n\t\t}\n\n\t\treturn { from: this.from, to: this.to, position: this.positionStart, size };\n\t}\n\n}\n"],"names":["EventDragAndDrop","constructor","getDateByPos","getPosByDate","getEvents","maxTryDuration","stickDistanceInPercents","magnetizeDistanceInMinutes","getFinalFrom","finalFrom","getFinalTo","finalTo","onDragStart","duration","startPosition","savedDuration","tryDuration","startBoundary","getBoundaryFromPosition","from","to","getDragBoundary","position","diff","previousPosition","calculateTryDuration","resetMagnetStamps","boundary","doMagnetize","getMagnetizedBoundary","size","Date","getTime","wasMagnetized","magnetizedTimeInterval","getMagnetizedTimeInterval","magnetizedFromPosition","wasMagnetizedTo","wasMagnetizedFrom","endMagnetStamp","startMagnetStamp","fromDate","toDate","magnetDistance","stickDistance","fromDateMax","setHours","toDateMin","events","event","eventFrom","eventTo","Math","abs","isAnyModifierKeyPressed","isUserTryingToTurnOffMagnet","window","altKey","shiftKey","ctrlKey","metaKey","ResizeDragAndDrop","timeInterval","minSize","isStartResizer","direction","positionStart","positionEnd","dy","max","timeFrom","getHours","getMinutes","timeTo"],"mappings":"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"}