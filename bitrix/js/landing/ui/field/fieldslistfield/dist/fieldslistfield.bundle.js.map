{"version":3,"file":"fieldslistfield.bundle.js","sources":["../src/internal/requisite-settings-field.js","../src/fieldslistfield.js"],"sourcesContent":["import {Dom, Tag, Loc} from 'main.core';\nimport {BaseField} from 'landing.ui.field.basefield';\n\nimport './css/style.css';\n\nexport class RequisiteSettingsField extends BaseField\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Field.FieldsListField.RequisiteSettingsField');\n\t\tthis.subscribeFromOptions(options.events);\n\n\t\tDom.replace(this.input, this.getSettingsLayout());\n\t}\n\n\tgetOptions(): {[key: string]: any}\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetSettingsLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('settingsLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-field-requisite-settings\">\n\t\t\t\t\t${[...this.getCheckboxTree().keys()].map((checkbox) => checkbox.layout)}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetCheckboxTree(): Map<BX.Landing.UI.Field.Checkbox, BX.Landing.UI.Field.Checkbox>\n\t{\n\t\treturn this.cache.remember('checkboxTree', () => {\n\t\t\tconst requisites = this.getOptions().value;\n\n\t\t\treturn requisites.reduce((map: Map, requisite) => {\n\t\t\t\tconst fieldsCheckbox = new BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: `${requisite.id}_fields`,\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: requisite.fields.map((field) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tname: field.label,\n\t\t\t\t\t\t\tvalue: field.name,\n\t\t\t\t\t\t\tchecked: field.disabled !== false,\n\t\t\t\t\t\t};\n\t\t\t\t\t}),\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tthis.emit('onChange');\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tconst onFieldSettingsLinkClick = (event: MouseEvent) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\tif (!categoryCheckbox.layout.contains(fieldsCheckbox.layout))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.append(fieldsCheckbox.layout, categoryCheckbox.layout);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(fieldsCheckbox.layout);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tconst fieldSettingsLink = Tag.render`\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"ui-link ui-link-dashed\"\n\t\t\t\t\t\tonclick=\"${onFieldSettingsLinkClick}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${Loc.getMessage('LANDING_FIELDS_ITEM_REQUISITE_SETTINGS_FIELDS_LABEL')}\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\n\t\t\t\tconst categoryCheckbox = new BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: requisite.id,\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: [{\n\t\t\t\t\t\tname: requisite.label,\n\t\t\t\t\t\tvalue: requisite.id,\n\t\t\t\t\t\tchecked: requisite.disabled !== false,\n\t\t\t\t\t}],\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tthis.emit('onChange');\n\n\t\t\t\t\t\tconst labelLayout = categoryCheckbox.layout\n\t\t\t\t\t\t\t.querySelector('.landing-ui-field-checkbox-item-label');\n\n\t\t\t\t\t\tif (categoryCheckbox.getValue().length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.append(fieldSettingsLink, labelLayout);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.remove(fieldSettingsLink);\n\t\t\t\t\t\t\tDom.remove(fieldsCheckbox.layout);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tif (requisite.disabled !== false)\n\t\t\t\t{\n\t\t\t\t\tconst labelLayout = categoryCheckbox.layout\n\t\t\t\t\t\t.querySelector('.landing-ui-field-checkbox-item-label');\n\t\t\t\t\tDom.append(fieldSettingsLink, labelLayout);\n\t\t\t\t}\n\n\t\t\t\tmap.set(\n\t\t\t\t\tcategoryCheckbox,\n\t\t\t\t\tfieldsCheckbox,\n\t\t\t\t);\n\n\t\t\t\treturn map;\n\t\t\t}, new Map());\n\t\t});\n\t}\n\n\tgetValue(): Array<{disabled: boolean, fields: Array<{disabled: boolean}>}>\n\t{\n\t\tconst entries = [...this.getCheckboxTree().entries()];\n\n\t\treturn entries.reduce((acc, [categoryCheckbox, fieldsCheckbox], index) => {\n\t\t\tconst fieldsValue = fieldsCheckbox.getValue();\n\t\t\tacc.push({\n\t\t\t\tid: categoryCheckbox.selector,\n\t\t\t\tdisabled: categoryCheckbox.getValue().length === 0,\n\t\t\t\tfields: this.getOptions().value[index].fields.map((field) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: field.name,\n\t\t\t\t\t\tdisabled: !fieldsValue.includes(field.name),\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t\t});\n\n\t\t\treturn acc;\n\t\t}, []);\n\t}\n}","import 'ui.design-tokens';\n\nimport {BaseField} from 'landing.ui.field.basefield';\nimport {Loc} from 'landing.loc';\nimport {Dom, Runtime, Tag, Text, Type} from 'main.core';\nimport {Draggable} from 'ui.draganddrop.draggable';\nimport {FieldsPanel} from 'landing.ui.panel.fieldspanel';\nimport {ListItem, type ListItemOptions} from 'landing.ui.component.listitem';\nimport {ActionPanel} from 'landing.ui.component.actionpanel';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {BaseEvent} from 'main.core.events';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {FormClient} from 'crm.form.client';\nimport {ListSettingsField} from 'landing.ui.field.listsettingsfield';\nimport {SeparatorPanel} from 'landing.ui.panel.separatorpanel';\nimport {PageObject} from 'landing.pageobject';\nimport {Loader} from 'main.loader';\nimport {ProductField} from 'landing.ui.field.productfield';\nimport 'calendar.resourcebookinguserfield';\nimport 'socnetlogdest';\nimport 'ui.hint';\nimport {IconButton} from 'landing.ui.component.iconbutton';\nimport {RequisiteSettingsField} from './internal/requisite-settings-field';\n\nimport './css/style.css';\n\n\nexport class FieldsListField extends BaseField\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Field.FieldsListField');\n\t\tthis.setLayoutClass('landing-ui-field-fields-list');\n\n\t\tthis.onSelectFieldButtonClick = this.onSelectFieldButtonClick.bind(this);\n\t\tthis.onSelectProductsButtonClick = this.onSelectProductsButtonClick.bind(this);\n\t\tthis.onSelectSeparatorButtonClick = this.onSelectSeparatorButtonClick.bind(this);\n\t\tthis.onItemRemove = this.onItemRemove.bind(this);\n\t\tthis.onItemEdit = this.onItemEdit.bind(this);\n\t\tthis.onDragEnd = this.onDragEnd.bind(this);\n\t\tthis.onFormChange = this.onFormChange.bind(this);\n\n\t\tthis.items = [];\n\n\t\tthis.options.items.forEach((itemOptions) => {\n\t\t\tthis.addItem(itemOptions);\n\t\t});\n\n\t\tthis.actionPanel = new ActionPanel({\n\t\t\trenderTo: this.layout,\n\t\t\tleft: [\n\t\t\t\t{\n\t\t\t\t\tid: 'selectField',\n\t\t\t\t\ttext: Loc.getMessage('LANDING_FIELDS_ADD_FIELD_BUTTON_TITLE'),\n\t\t\t\t\tonClick: this.onSelectFieldButtonClick,\n\t\t\t\t},\n\t\t\t],\n\t\t\tright: [\n\t\t\t\t{\n\t\t\t\t\tid: 'addProducts',\n\t\t\t\t\ttext: Loc.getMessage('LANDING_FIELDS_SELECT_PRODUCTS_BUTTON_TITLE'),\n\t\t\t\t\tonClick: this.onSelectProductsButtonClick,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'selectSeparator',\n\t\t\t\t\ttext: Loc.getMessage('LANDING_FIELDS_SELECT_SEPARATOR_BUTTON_TITLE'),\n\t\t\t\t\tonClick: this.onSelectSeparatorButtonClick,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tthis.draggable = new Draggable({\n\t\t\tcontext: window.parent,\n\t\t\tcontainer: this.getListContainer(),\n\t\t\tdraggable: '.landing-ui-component-list-item',\n\t\t\tdragElement: '.landing-ui-button-icon-drag',\n\t\t\ttype: Draggable.MOVE,\n\t\t\toffset: {\n\t\t\t\ty: -62,\n\t\t\t},\n\t\t});\n\n\t\tthis.draggable.subscribe('end', this.onDragEnd);\n\t}\n\n\tcreateInput(): HTMLDivElement\n\t{\n\t\treturn this.getListContainer();\n\t}\n\n\tgetCrmFieldById(id: string)\n\t{\n\t\treturn Object.values(this.options.crmFields)\n\t\t\t.reduce((acc, category) => {\n\t\t\t\treturn [...acc, ...category.FIELDS];\n\t\t\t}, [])\n\t\t\t.find((currentField) => {\n\t\t\t\treturn currentField.name === id;\n\t\t\t});\n\t}\n\n\tgetCrmFieldCategoryById(id: string)\n\t{\n\t\treturn this.options.crmFields[id];\n\t}\n\n\taddItem(itemOptions)\n\t{\n\t\treturn this.createItem(itemOptions)\n\t\t\t.then((item) => {\n\t\t\t\tthis.items.push(item);\n\t\t\t\tDom.append(item.getLayout(), this.getListContainer());\n\t\t\t});\n\t}\n\n\tprependItem(itemOptions)\n\t{\n\t\treturn this.createItem(itemOptions)\n\t\t\t.then((item) => {\n\t\t\t\tthis.items.unshift(item);\n\t\t\t\tDom.prepend(item.getLayout(), this.getListContainer());\n\t\t\t});\n\t}\n\n\tinsertItemAfterIndex(itemOptions, index)\n\t{\n\t\treturn this.createItem(itemOptions)\n\t\t\t.then((item) => {\n\t\t\t\tthis.items.splice((index + 1), 0, item);\n\t\t\t\tDom.insertAfter(item.getLayout(), this.getListContainer().childNodes[index]);\n\t\t\t});\n\t}\n\n\tstatic isSeparator(fieldId: ?string): boolean\n\t{\n\t\tif (Type.isStringFilled(fieldId))\n\t\t{\n\t\t\treturn (\n\t\t\t\tfieldId.startsWith('hr')\n\t\t\t\t|| fieldId.startsWith('section')\n\t\t\t\t|| fieldId.startsWith('page')\n\t\t\t);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic getSeparatorTitle(fieldId: ?string): string\n\t{\n\t\tif (Type.isStringFilled(fieldId))\n\t\t{\n\t\t\tif (fieldId.startsWith('hr'))\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('LANDING_SEPARATOR_SOLID_LINE');\n\t\t\t}\n\n\t\t\tif (fieldId.startsWith('section'))\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('LANDING_SEPARATOR_HEADER');\n\t\t\t}\n\n\t\t\tif (fieldId.startsWith('page'))\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('LANDING_SEPARATOR_PAGE');\n\t\t\t}\n\t\t}\n\n\t\treturn Loc.getMessage('LANDING_FIELDS_LIST_FIELD_SEPARATOR_TITLE');\n\t}\n\n\tisFieldAvailable(fieldId: ?string): boolean\n\t{\n\t\tif (Type.isStringFilled(fieldId))\n\t\t{\n\t\t\tif (fieldId.startsWith('product_'))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn Type.isPlainObject(\n\t\t\t\tthis.getCrmFieldById(fieldId),\n\t\t\t);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetFieldItemTitle(fieldId: ?string): string\n\t{\n\t\tif (this.isFieldAvailable(fieldId))\n\t\t{\n\t\t\tif (fieldId.startsWith('product_'))\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('LANDING_FIELDS_LIST_FIELD_PRODUCTS_TITLE');\n\t\t\t}\n\n\t\t\tconst crmField = this.getCrmFieldById(fieldId);\n\t\t\tconst crmFieldCategory = this.getCrmFieldCategoryById(crmField.entity_name);\n\n\t\t\treturn `${crmField.caption} Â· ${crmFieldCategory.CAPTION}`;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tcreateResourceBookingFieldController(options: {[key: string]: any})\n\t{\n\t\tif (options.type === 'resourcebooking')\n\t\t{\n\t\t\tconst root = PageObject.getRootWindow();\n\t\t\tconst crmField = this.getCrmFieldById(options.id);\n\t\t\treturn root.BX.Calendar.ResourcebookingUserfield.initCrmFormFieldController({\n\t\t\t\tfield: {\n\t\t\t\t\t...options,\n\t\t\t\t\tdict: crmField,\n\t\t\t\t\tnode: Tag.render`<div><div class=\"crm-webform-resourcebooking-wrap\"></div></div>`,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcreateItem(\n\t\toptions: {\n\t\t\tid: string,\n\t\t\tlabel: string,\n\t\t\tdescription: string,\n\t\t\tcontent?: any,\n\t\t\ttype?: any,\n\t\t\tseparatorTitle?: any,\n\t\t},\n\t): Promise<ListItem>\n\t{\n\t\tconst listItemOptions: ListItemOptions = {\n\t\t\tid: options.id,\n\t\t\ttype: options.type ? options.type : '',\n\t\t\tcontent: options.content,\n\t\t\tsourceOptions: {...options},\n\t\t\tdraggable: true,\n\t\t\tremovable: true,\n\t\t\tonRemove: this.onItemRemove,\n\t\t\tonEdit: this.onItemEdit,\n\t\t\tonFormChange: this.onFormChange,\n\t\t\tform: this.createFieldSettingsForm(options),\n\t\t};\n\n\t\tif (!FieldsListField.isSeparator(options.id))\n\t\t{\n\t\t\tif (this.isFieldAvailable(options.id))\n\t\t\t{\n\t\t\t\tlistItemOptions.title = this.getFieldItemTitle(options.id);\n\n\t\t\t\tconst crmField = this.getCrmFieldById(options.id);\n\t\t\t\tlistItemOptions.description = options.label || (crmField ? crmField.caption : '');\n\t\t\t\tlistItemOptions.editable = true;\n\t\t\t\tlistItemOptions.isSeparator = false;\n\t\t\t\tlistItemOptions.fieldController = this.createResourceBookingFieldController(options);\n\n\n\t\t\t\tif (options.editing.supportAutocomplete)\n\t\t\t\t{\n\t\t\t\t\tconst autocompleteButton = new IconButton({\n\t\t\t\t\t\tid: 'autocomplete',\n\t\t\t\t\t\ttype: (() => {\n\t\t\t\t\t\t\tif (options.autocomplete)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn IconButton.Types.user1Active;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn IconButton.Types.user1;\n\t\t\t\t\t\t})(),\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t\tcursor: 'default',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttitle: (() => {\n\t\t\t\t\t\t\tif (options.autocomplete)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn Loc.getMessage('LANDING_FIELDS_ITEM_AUTOCOMPLETE_ENABLED');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn Loc.getMessage('LANDING_FIELDS_ITEM_AUTOCOMPLETE_DISABLED');\n\t\t\t\t\t\t})(),\n\t\t\t\t\t});\n\n\t\t\t\t\tlistItemOptions.form.subscribe('onChange', (event: BaseEvent) => {\n\t\t\t\t\t\tif (event.getTarget().serialize().autocomplete)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tautocompleteButton.setType(IconButton.Types.user1Active);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tautocompleteButton.setType(IconButton.Types.user1);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tlistItemOptions.actions = [\n\t\t\t\t\t\tautocompleteButton,\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\tconst listItem = new ListItem(listItemOptions);\n\n\t\t\t\tif (listItemOptions.fieldController)\n\t\t\t\t{\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tif (Type.isFunction(listItemOptions.fieldController.subscribe))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlistItemOptions.fieldController.subscribe('afterInit', (event) => {\n\t\t\t\t\t\t\t\toptions.booking.settings_data = event.getData().settings.data;\n\t\t\t\t\t\t\t\tresolve(listItem);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve(listItem);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn Promise.resolve(listItem);\n\t\t\t}\n\n\t\t\tlistItemOptions.editable = false;\n\t\t\tlistItemOptions.isSeparator = false;\n\t\t\tlistItemOptions.title = '';\n\t\t\tlistItemOptions.description = Loc.getMessage('LANDING_FIELDS_ITEM_FIELD_UNAVAILABLE');\n\t\t\tlistItemOptions.error = true;\n\n\t\t\tconst listItem = new ListItem(listItemOptions);\n\n\t\t\treturn Promise.resolve(listItem);\n\t\t}\n\n\t\tlistItemOptions.isSeparator = true;\n\t\tlistItemOptions.editable = !String(options.id).startsWith('hr_');\n\t\tlistItemOptions.title = FieldsListField.getSeparatorTitle(options.id);\n\n\t\tif (Type.isString(options.label))\n\t\t{\n\t\t\tlistItemOptions.description = options.label;\n\t\t}\n\t\telse if (String(options.id).startsWith('hr_'))\n\t\t{\n\t\t\tlistItemOptions.description = FieldsListField.getSeparatorTitle(options.id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst crmField = this.getCrmFieldById(options.id);\n\t\t\tif (Type.isPlainObject(crmField) && Type.isString(crmField.caption))\n\t\t\t{\n\t\t\t\tlistItemOptions.description = crmField.caption;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlistItemOptions.description = '';\n\t\t\t}\n\t\t}\n\n\t\tconst listItem = new ListItem(listItemOptions);\n\n\t\treturn Promise.resolve(listItem);\n\t}\n\n\tcreateCustomPriceDropdown(field)\n\t{\n\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\tid: 'customPrice',\n\t\t\tselector: 'customPrice',\n\t\t\titems: [\n\t\t\t\t{name: Loc.getMessage('LANDING_FIELDS_LIST_FIELD_PRODUCTS_ALLOW_CUSTOM_PRICE_NOT_SELECTED'), value: null},\n\t\t\t\t...(field.items.map((item) => {\n\t\t\t\t\treturn {name: item.label, value: item.value};\n\t\t\t\t})),\n\t\t\t],\n\t\t\tcontent: field.items.reduce((acc, item) => {\n\t\t\t\tif (item.changeablePrice && acc === null)\n\t\t\t\t{\n\t\t\t\t\treturn item.value;\n\t\t\t\t}\n\n\t\t\t\treturn acc;\n\t\t\t}, null),\n\t\t});\n\t}\n\n\tcreateProductDefaultValueDropdown(field)\n\t{\n\t\tconst defaultValueField = new BX.Landing.UI.Field.Dropdown({\n\t\t\tid: 'productDefaultValue',\n\t\t\tselector: 'value',\n\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_LIST_DEFAULT_VALUE_TITLE'),\n\t\t\tcontent: field.value,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\tlabel: Loc.getMessage('LANDING_FORM_DEFAULT_VALUE_NOT_SELECTED'),\n\t\t\t\t\tvalue: null,\n\t\t\t\t},\n\t\t\t\t...field.items,\n\t\t\t].map((item) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: item.label,\n\t\t\t\t\tvalue: item.value,\n\t\t\t\t};\n\t\t\t}),\n\t\t});\n\n\t\tif (field.items.length > 0)\n\t\t{\n\t\t\tdefaultValueField.enable();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdefaultValueField.disable();\n\t\t}\n\n\t\treturn defaultValueField;\n\t}\n\n\tcreateDefaultValueField(field): BX.Landing.UI.Field.Dropdown\n\t{\n\t\treturn new BX.Landing.UI.Field.Dropdown({\n\t\t\tselector: 'value',\n\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_LIST_DEFAULT_VALUE_TITLE'),\n\t\t\tcontent: field.value,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\tlabel: Loc.getMessage('LANDING_FORM_DEFAULT_VALUE_NOT_SELECTED'),\n\t\t\t\t\tvalue: null,\n\t\t\t\t},\n\t\t\t\t...field.items,\n\t\t\t].map((item) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: item.label,\n\t\t\t\t\tvalue: item.value,\n\t\t\t\t};\n\t\t\t}),\n\t\t});\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tcreateFieldSettingsForm(field)\n\t{\n\t\tconst fields = [];\n\t\tconst form = new FormSettingsForm({\n\t\t\tserializeModifier(value) {\n\t\t\t\tconst modifiedValue = {...value};\n\t\t\t\tif (Reflect.has(value, 'label'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.label = Text.decode(value.label);\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'required'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.required = value.required.includes('required');\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'multiple'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.multiple = value.multiple.includes('multiple');\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'bigPic'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.bigPic = value.bigPic.includes('bigPic');\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'value') && Type.isArrayFilled(value.items))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.items = modifiedValue.items.map((item) => {\n\t\t\t\t\t\titem.selected = (value.value === item.value);\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'products'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.items = Runtime.clone(value.products);\n\t\t\t\t\tif (!Type.isPlainObject(modifiedValue.editing))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodifiedValue.editing = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Reflect.has(value, 'value') && Type.isArrayFilled(modifiedValue.items))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodifiedValue.items.forEach((item) => {\n\t\t\t\t\t\t\titem.selected = (String(value.value) === String(item.value));\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tmodifiedValue.editing.catalog = Runtime.clone(value.products);\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'valueType'))\n\t\t\t\t{\n\t\t\t\t\tif (!Type.isPlainObject(modifiedValue.editing))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodifiedValue.editing = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isPlainObject(modifiedValue.editing.editable))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodifiedValue.editing.editable = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tmodifiedValue.editing.editable.valueType = value.valueType;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArray(value.useCustomPrice))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.items.forEach((item) => {\n\t\t\t\t\t\titem.changeablePrice = (\n\t\t\t\t\t\t\tvalue.useCustomPrice.includes('useCustomPrice')\n\t\t\t\t\t\t\t&& String(item.value) === String(value.customPrice)\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\n\t\t\t\t\tdelete modifiedValue.customPrice;\n\t\t\t\t\tdelete modifiedValue.useCustomPrice;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArray(value.autocomplete))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.autocomplete = value.autocomplete.length > 0;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArrayFilled(value.contentTypes))\n\t\t\t\t{\n\t\t\t\t\tif (value.contentTypes.includes('any'))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodifiedValue.contentTypes = [];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArray(value.requisite))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.requisite = {\n\t\t\t\t\t\tpresets: value.requisite,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn modifiedValue;\n\t\t\t},\n\t\t});\n\n\t\tif (field.type === 'product')\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew ProductField({\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_LIST_FIELD_PRODUCTS_TITLE2'),\n\t\t\t\t\tselector: 'products',\n\t\t\t\t\titems: field.editing.catalog || [],\n\t\t\t\t\tiblockId: this.options.dictionary.catalog.id,\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tconst oldCustomPrice = form.fields.get('customPrice');\n\t\t\t\t\t\tconst newCustomPrice = this.createCustomPriceDropdown({\n\t\t\t\t\t\t\t...field,\n\t\t\t\t\t\t\titems: form.serialize().items,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst useCustomPrice = field.items.some((item) => {\n\t\t\t\t\t\t\treturn item.changeablePrice;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst useCustomPriceField = form.fields.get('useCustomPrice');\n\n\t\t\t\t\t\tif (useCustomPrice || useCustomPriceField.getValue().includes('useCustomPrice'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.style(newCustomPrice.getLayout(), 'display', null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.style(newCustomPrice.getLayout(), 'display', 'none');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnewCustomPrice.setValue(oldCustomPrice.getValue());\n\n\t\t\t\t\t\tform.replaceField(\n\t\t\t\t\t\t\toldCustomPrice,\n\t\t\t\t\t\t\tnewCustomPrice,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst oldDefaultValue = form.fields.get('productDefaultValue');\n\t\t\t\t\t\tconst newDefaultValue = this.createProductDefaultValueDropdown({\n\t\t\t\t\t\t\t...field,\n\t\t\t\t\t\t\titems: form.serialize().items,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tform.replaceField(\n\t\t\t\t\t\t\toldDefaultValue,\n\t\t\t\t\t\t\tnewDefaultValue,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.editing.hasLabel)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew TextField({\n\t\t\t\t\tselector: 'label',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_LABEL_FIELD_TITLE'),\n\t\t\t\t\tcontent: field.label,\n\t\t\t\t\ttextOnly: true,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.type === 'rq')\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew RequisiteSettingsField({\n\t\t\t\t\tselector: 'requisite',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_REQUISITE_SETTINGS_LABEL'),\n\t\t\t\t\tvalue: field.requisite.presets,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.editing.canBeRequired)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: 'required',\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_REQUIRED_FIELD_TITLE'),\n\t\t\t\t\t\t\tvalue: 'required',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvalue: field.required ? ['required'] : [],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.editing.canBeMultiple)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: 'multiple',\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_MULTIPLE_FIELD_TITLE'),\n\t\t\t\t\t\t\tvalue: 'multiple',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvalue: field.multiple ? ['multiple'] : [],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.editing.hasStringDefaultValue)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew TextField({\n\t\t\t\t\tselector: 'value',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_DEFAULT_VALUE_FIELD_TITLE'),\n\t\t\t\t\tcontent: field.value,\n\t\t\t\t\ttextOnly: true,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.type === 'product')\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: 'bigPic',\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_LIST_FIELD_PRODUCTS_SHOW_BIG_PICTURE'),\n\t\t\t\t\t\t\tvalue: 'bigPic',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvalue: field.bigPic ? ['bigPic'] : [],\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tconst useCustomPrice = field.items.some((item) => {\n\t\t\t\treturn item.changeablePrice;\n\t\t\t});\n\n\t\t\tconst customPriceField = this.createCustomPriceDropdown(field);\n\t\t\tif (useCustomPrice)\n\t\t\t{\n\t\t\t\tDom.style(customPriceField.getLayout(), 'display', null);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.style(customPriceField.getLayout(), 'display', 'none');\n\t\t\t}\n\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tid: 'useCustomPrice',\n\t\t\t\t\tselector: 'useCustomPrice',\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_LIST_FIELD_PRODUCTS_ALLOW_CUSTOM_PRICE'),\n\t\t\t\t\t\t\tvalue: 'useCustomPrice',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvalue: useCustomPrice ? ['useCustomPrice'] : [],\n\t\t\t\t\tonChange: (checkbox) => {\n\t\t\t\t\t\tif (checkbox instanceof BaseField)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst customPriceField = form.fields.get('customPrice');\n\t\t\t\t\t\t\tif (checkbox.getValue().includes('useCustomPrice'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.style(customPriceField.getLayout(), 'display', null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.style(customPriceField.getLayout(), 'display', 'none');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tfields.push(customPriceField);\n\n\t\t\tfields.push(this.createProductDefaultValueDropdown(field));\n\t\t}\n\n\t\tif (['list', 'radio', 'checkbox'].includes(field.type) && field.editing.items.length > 0)\n\t\t{\n\t\t\tconst defaultValueField = this.createDefaultValueField(field);\n\t\t\tconst listSettingsField = new ListSettingsField({\n\t\t\t\tselector: 'items',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_LIST_SETTINGS_TITLE'),\n\t\t\t\titems: (() => {\n\t\t\t\t\treturn field.editing.items.map((item) => {\n\t\t\t\t\t\tconst selectedItem = field.items.find((currentItem) => {\n\t\t\t\t\t\t\treturn String(currentItem.value) === String(item.id);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst checked = !!selectedItem;\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tname: checked ? selectedItem.label : item.value,\n\t\t\t\t\t\t\tvalue: item.id,\n\t\t\t\t\t\t\tchecked,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t})(),\n\t\t\t});\n\n\t\t\tlistSettingsField.subscribe('onChange', () => {\n\t\t\t\tconst currentDefaultValueField = form.fields.find((item) => {\n\t\t\t\t\treturn item.selector === 'value';\n\t\t\t\t});\n\t\t\t\tform.replaceField(\n\t\t\t\t\tcurrentDefaultValueField,\n\t\t\t\t\tthis.createDefaultValueField({\n\t\t\t\t\t\t...field,\n\t\t\t\t\t\titems: form.serialize().items,\n\t\t\t\t\t\tvalue: currentDefaultValueField.getValue(),\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tfields.push(listSettingsField);\n\t\t\tfields.push(defaultValueField);\n\t\t}\n\n\t\tif (\n\t\t\tType.isPlainObject(field.editing)\n\t\t\t&& Type.isArrayFilled(field.editing.valueTypes)\n\t\t)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Dropdown({\n\t\t\t\t\tselector: 'valueType',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_VALUE_TYPE'),\n\t\t\t\t\tcontent: field.editing.editable.valueType,\n\t\t\t\t\titems: field.editing.valueTypes.map((item) => {\n\t\t\t\t\t\treturn {name: item.name, value: item.id};\n\t\t\t\t\t}),\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tfield.type === 'file'\n\t\t\t&& Type.isArrayFilled(this.options.dictionary.contentTypes)\n\t\t)\n\t\t{\n\t\t\tconst adjustContentTypesField = (value) => {\n\t\t\t\tif (value.includes('any'))\n\t\t\t\t{\n\t\t\t\t\tconst inputs = [...contentTypesField.layout\n\t\t\t\t\t\t.querySelectorAll('.landing-ui-field-checkbox-item-checkbox')];\n\t\t\t\t\tinputs.forEach((input) => {\n\t\t\t\t\t\tif (Dom.attr(input, 'value') === 'any')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.removeClass(input.closest('.landing-ui-field-checkbox-item'), 'landing-ui-disabled');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.addClass(input.closest('.landing-ui-field-checkbox-item'), 'landing-ui-disabled');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst inputs = [...contentTypesField.layout\n\t\t\t\t\t\t.querySelectorAll('.landing-ui-field-checkbox-item-checkbox')];\n\t\t\t\t\tinputs.forEach((input) => {\n\t\t\t\t\t\tDom.removeClass(input.closest('.landing-ui-field-checkbox-item'), 'landing-ui-disabled');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst selectedContentTypes = Type.isArrayFilled(field.contentTypes) ? field.contentTypes : ['any'];\n\t\t\tlet lastValue = selectedContentTypes;\n\t\t\tconst contentTypesField = new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'contentTypes',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_ALLOWED_FILE_TYPE'),\n\t\t\t\tvalue: selectedContentTypes,\n\t\t\t\titems: [\n\t\t\t\t\t(() => {\n\t\t\t\t\t\tif (Loc.hasMessage('LANDING_FIELDS_ITEM_FORM_ALLOWED_ANY_FILE_TYPE'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_ALLOWED_ANY_FILE_TYPE'),\n\t\t\t\t\t\t\t\tvalue: 'any',\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t})(),\n\t\t\t\t\t...this.options.dictionary.contentTypes.map((item) => {\n\t\t\t\t\t\tconst hint = item.hint\n\t\t\t\t\t\t\t? `<span class=\"ui-hint\" data-hint=\"${Text.encode(item.hint)}\"></span>`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\thtml: `<span style=\"display: flex; align-items: center;\">${Text.encode(item.name)} ${hint}</span>`,\n\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\tvalue: item.id\n\t\t\t\t\t\t};\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t\tonValueChange: () => {\n\t\t\t\t\tconst value = contentTypesField.getValue();\n\n\t\t\t\t\tif (value.includes('any'))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (lastValue.includes('any'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontentTypesField.setValue(value.filter((item) => item !== 'any'));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontentTypesField.setValue(['any']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlastValue = contentTypesField.getValue();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tBX.UI.Hint.init(contentTypesField.getLayout());\n\t\t\tfields.push(contentTypesField);\n\t\t}\n\n\t\tif (Text.toBoolean(field.editing.supportAutocomplete) === true)\n\t\t{\n\t\t\tfields.push(new BX.Landing.UI.Field.Checkbox({\n\t\t\t\tselector: 'autocomplete',\n\t\t\t\tcompact: true,\n\t\t\t\tmultiple: false,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_ITEM_ENABLE_AUTOCOMPLETE'),\n\t\t\t\t\t\thtml: Text.encode(Loc.getMessage('LANDING_FIELDS_ITEM_ENABLE_AUTOCOMPLETE'))\n\t\t\t\t\t\t\t+ `<span \n\t\t\t\t\t\t\t\t\tclass=\"landing-ui-form-help\" \n\t\t\t\t\t\t\t\t\tstyle=\"margin: 0 0 0 5px;\"\n\t\t\t\t\t\t\t\t\tonclick=\"top.BX.Helper.show('redirect=detail&code=14611764'); return false;\"\n\t\t\t\t\t\t\t\t><a href=\"javascript: void();\"></a></span>`\n\t\t\t\t\t\t,\n\t\t\t\t\t\tvalue: 'autocomplete',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tvalue: field.autocomplete ? ['autocomplete'] : false,\n\t\t\t}));\n\t\t}\n\n\t\tif (Text.toBoolean(field.editing.hasHint) === true)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew TextField({\n\t\t\t\t\tselector: 'hint',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_FIELD_HINT_TITLE'),\n\t\t\t\t\tcontent: field.hint,\n\t\t\t\t\ttextOnly: true,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (Text.toBoolean(field.editing.supportHintOnFocus) === true)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: 'hintOnFocus',\n\t\t\t\t\tcompact: true,\n\t\t\t\t\tmultiple: false,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_ITEM_ENABLE_HINT_ON_FOCUS'),\n\t\t\t\t\t\t\tvalue: 'hintOnFocus',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvalue: field.hintOnFocus ? ['hintOnFocus'] : false,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tfields.forEach((currentField) => {\n\t\t\tform.addField(currentField);\n\t\t});\n\n\t\treturn form;\n\t}\n\n\tgetListContainer(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('listContainer', () => {\n\t\t\treturn Tag.render`<div class=\"landing-ui-field-fields-list-container\"></div>`;\n\t\t});\n\t}\n\n\tonSelectFieldButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tFieldsPanel\n\t\t\t.getInstance({\n\t\t\t\tisLeadEnabled: this.options.isLeadEnabled,\n\t\t\t})\n\t\t\t.show({\n\t\t\t\tdisabledFields: this.items.map((item) => item.options.id),\n\t\t\t})\n\t\t\t.then((selectedFields) => {\n\t\t\t\tif (Type.isArrayFilled(selectedFields))\n\t\t\t\t{\n\t\t\t\t\tthis.options.crmFields = FieldsPanel.getInstance().getOriginalCrmFields();\n\t\t\t\t\tthis.onFieldsSelect(selectedFields);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tonFieldsSelect(selectedFields: Array<string>)\n\t{\n\t\tconst preparingOptions = {\n\t\t\tfields: selectedFields.map((fieldId) => {\n\t\t\t\treturn {name: fieldId};\n\t\t\t}),\n\t\t};\n\n\t\tvoid this.showLoader();\n\n\t\tFormClient.getInstance()\n\t\t\t.prepareOptions(this.options.formOptions, preparingOptions)\n\t\t\t.then((result) => {\n\t\t\t\tvoid this.hideLoader();\n\t\t\t\treturn Promise.all(\n\t\t\t\t\tresult.data.fields.map((field) => {\n\t\t\t\t\t\treturn this.addItem(field);\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t});\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.items.map((item) => {\n\t\t\treturn item.getValue();\n\t\t});\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tonSelectProductsButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst preparingOptions = {\n\t\t\tfields: [\n\t\t\t\t{type: 'product'},\n\t\t\t],\n\t\t};\n\n\t\tvoid this.showLoader();\n\n\t\tFormClient\n\t\t\t.getInstance()\n\t\t\t.prepareOptions(this.options.formOptions, preparingOptions)\n\t\t\t.then((result) => {\n\t\t\t\tvoid this.hideLoader();\n\n\t\t\t\tconst promises = result.data.fields.map((field) => {\n\t\t\t\t\treturn this.addItem(field);\n\t\t\t\t});\n\n\t\t\t\tPromise.all(promises)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tonSelectSeparatorButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tSeparatorPanel.getInstance()\n\t\t\t.show()\n\t\t\t.then((separator) => {\n\t\t\t\tconst fields = [separator];\n\n\t\t\t\tif (\n\t\t\t\t\tseparator.type === 'page'\n\t\t\t\t\t&& !this.items.find((item) => item.options.type === 'page')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tfields.push({...fields[0]});\n\t\t\t\t}\n\n\t\t\t\tvoid this.showLoader();\n\n\t\t\t\tFormClient.getInstance()\n\t\t\t\t\t.prepareOptions(this.options.formOptions, {fields})\n\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\tvoid this.hideLoader();\n\n\t\t\t\t\t\tlet separatorPromise = Promise.resolve();\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tseparator.type === 'page'\n\t\t\t\t\t\t\t&& !this.items.find((item) => item.options.type === 'page')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.data.fields[0].label = Loc.getMessage('LANDING_FIELDS_ITEM_PAGE_TITLE')\n\t\t\t\t\t\t\t\t.replace('#number#', 1);\n\t\t\t\t\t\t\tresult.data.fields[1].label = Loc.getMessage('LANDING_FIELDS_ITEM_PAGE_TITLE')\n\t\t\t\t\t\t\t\t.replace('#number#', 2);\n\n\t\t\t\t\t\t\tseparatorPromise = Promise.all([\n\t\t\t\t\t\t\t\tthis.prependItem(result.data.fields[0]),\n\t\t\t\t\t\t\t\tthis.insertItemAfterIndex(result.data.fields[1], 1),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.data.fields.forEach((field) => {\n\t\t\t\t\t\t\t\tconst [type] = field.id.split('_');\n\t\t\t\t\t\t\t\tconst count = this.items.filter((item) => {\n\t\t\t\t\t\t\t\t\treturn item.options.id.startsWith(type);\n\t\t\t\t\t\t\t\t}).length;\n\n\t\t\t\t\t\t\t\tif (type === 'page')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfield.label = Loc.getMessage('LANDING_FIELDS_ITEM_PAGE_TITLE')\n\t\t\t\t\t\t\t\t\t\t.replace('#number#', count + 1);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (type === 'section')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfield.label = Loc.getMessage('LANDING_FIELDS_ITEM_SECTION_TITLE')\n\t\t\t\t\t\t\t\t\t\t.replace('#number#', count + 1);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (type === 'hr')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfield.label = Loc.getMessage('LANDING_FIELDS_ITEM_LINE_TITLE')\n\t\t\t\t\t\t\t\t\t\t.replace('#number#', count + 1);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tseparatorPromise = this.addItem(field);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tseparatorPromise.then(() => {\n\t\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tonItemRemove(event: BaseEvent)\n\t{\n\t\tthis.items = this.items.filter((item) => {\n\t\t\treturn item !== event.getTarget();\n\t\t});\n\n\t\tthis.emit('onChange', {skipPrepare: true});\n\t}\n\n\tonItemEdit(event: BaseEvent)\n\t{\n\t\tconst {options} = event.getTarget();\n\t\tif (options.fieldController)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\toptions.fieldController.showSettingsPopup();\n\t\t\tsetTimeout(() => {\n\t\t\t\toptions.fieldController.settingsPopup.subscribeOnce('onClose', () => {\n\t\t\t\t\toptions.sourceOptions.booking.settings_data = options.fieldController.getSettings().data;\n\n\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\tconst {settings_data} = options.sourceOptions.booking;\n\t\t\t\t\tObject.keys(settings_data).forEach((key) => {\n\t\t\t\t\t\tif (Type.isArray(settings_data[key].value))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsettings_data[key].value = settings_data[key].value.join('|');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t});\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tonFormChange(event: BaseEvent)\n\t{\n\t\tthis.emit('onChange', {skipPrepare: true});\n\n\t\tconst target = event.getTarget();\n\t\tconst value = target.getValue();\n\n\t\ttarget.setDescription(value.label);\n\t}\n\n\tonDragEnd()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.items = [...this.getListContainer().children].map((itemNode) => {\n\t\t\t\tconst itemNodeId = Dom.attr(itemNode, 'data-id');\n\t\t\t\treturn this.items.find((item) => {\n\t\t\t\t\treturn item.options.id === itemNodeId;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t});\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn new Loader({\n\t\t\t\tsize: 50,\n\t\t\t\tmode: 'inline',\n\t\t\t\toffset: {\n\t\t\t\t\ttop: '5px',\n\t\t\t\t\tleft: '225px',\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tshowLoader(): Promise<any>\n\t{\n\t\tconst loader = this.getLoader();\n\t\tconst container = this.getListContainer();\n\t\tDom.append(loader.layout, container);\n\t\treturn loader.show(container);\n\t}\n\n\thideLoader(): Promise<any>\n\t{\n\t\tconst loader = this.getLoader();\n\t\tDom.remove(loader.layout);\n\t\treturn loader.hide();\n\t}\n}"],"names":["RequisiteSettingsField","options","setEventNamespace","subscribeFromOptions","events","Dom","replace","input","getSettingsLayout","cache","remember","Tag","render","getCheckboxTree","keys","map","checkbox","layout","requisites","getOptions","value","reduce","requisite","fieldsCheckbox","BX","Landing","UI","Field","Checkbox","selector","id","compact","items","fields","field","name","label","checked","disabled","onChange","emit","onFieldSettingsLinkClick","event","preventDefault","stopPropagation","categoryCheckbox","contains","append","remove","fieldSettingsLink","Loc","getMessage","labelLayout","querySelector","getValue","length","set","Map","entries","acc","index","fieldsValue","push","includes","BaseField","FieldsListField","setLayoutClass","onSelectFieldButtonClick","bind","onSelectProductsButtonClick","onSelectSeparatorButtonClick","onItemRemove","onItemEdit","onDragEnd","onFormChange","forEach","itemOptions","addItem","actionPanel","ActionPanel","renderTo","left","text","onClick","right","draggable","Draggable","context","window","parent","container","getListContainer","dragElement","type","MOVE","offset","y","subscribe","Object","values","crmFields","category","FIELDS","find","currentField","createItem","then","item","getLayout","unshift","prepend","splice","insertAfter","childNodes","fieldId","Type","isStringFilled","startsWith","isPlainObject","getCrmFieldById","isFieldAvailable","crmField","crmFieldCategory","getCrmFieldCategoryById","entity_name","caption","CAPTION","root","PageObject","getRootWindow","Calendar","ResourcebookingUserfield","initCrmFormFieldController","dict","node","listItemOptions","content","sourceOptions","removable","onRemove","onEdit","form","createFieldSettingsForm","isSeparator","title","getFieldItemTitle","description","editable","fieldController","createResourceBookingFieldController","editing","supportAutocomplete","autocompleteButton","IconButton","autocomplete","Types","user1Active","user1","style","opacity","cursor","getTarget","serialize","setType","actions","listItem","ListItem","Promise","resolve","isFunction","booking","settings_data","getData","settings","data","error","String","getSeparatorTitle","isString","Dropdown","changeablePrice","defaultValueField","enable","disable","FormSettingsForm","serializeModifier","modifiedValue","Reflect","has","Text","decode","required","multiple","bigPic","isArrayFilled","selected","Runtime","clone","products","catalog","valueType","isArray","useCustomPrice","customPrice","contentTypes","presets","ProductField","iblockId","dictionary","oldCustomPrice","get","newCustomPrice","createCustomPriceDropdown","some","useCustomPriceField","setValue","replaceField","oldDefaultValue","newDefaultValue","createProductDefaultValueDropdown","hasLabel","TextField","textOnly","canBeRequired","canBeMultiple","hasStringDefaultValue","customPriceField","createDefaultValueField","listSettingsField","ListSettingsField","selectedItem","currentItem","currentDefaultValueField","valueTypes","selectedContentTypes","lastValue","contentTypesField","hasMessage","undefined","hint","encode","html","onValueChange","filter","Hint","init","toBoolean","hasHint","supportHintOnFocus","hintOnFocus","addField","FieldsPanel","getInstance","isLeadEnabled","show","disabledFields","selectedFields","getOriginalCrmFields","onFieldsSelect","preparingOptions","showLoader","FormClient","prepareOptions","formOptions","result","hideLoader","all","skipPrepare","promises","SeparatorPanel","separator","separatorPromise","prependItem","insertItemAfterIndex","split","count","showSettingsPopup","setTimeout","settingsPopup","subscribeOnce","getSettings","key","join","target","setDescription","children","itemNode","itemNodeId","attr","Loader","size","mode","top","loader","getLoader","hide"],"mappings":"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"}