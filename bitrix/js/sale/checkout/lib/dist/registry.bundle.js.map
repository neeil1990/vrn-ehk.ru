{"version":3,"file":"registry.bundle.js","sources":["../src/url.js","../src/pool.js","../src/timer.js","../src/basket.js","../src/product.js","../src/history.js"],"sourcesContent":["import { Uri } from 'main.core';\r\n\r\nexport class Url\r\n{\r\n\tstatic getCurrentUrl()\r\n\t{\r\n\t\treturn window.location.protocol + \"//\" + window.location.hostname + (window.location.port != '' ? ':' + window.location.port : '') +\r\n\t\t\twindow.location.pathname + window.location.search;\r\n\t}\r\n\t\r\n\tstatic addLinkParam(link, name, value)\r\n\t{\r\n\t\tif(!link.length)\r\n\t\t{\r\n\t\t\treturn '?' + name + '=' + value;\r\n\t\t}\r\n\t\tlink = Uri.removeParam(link, name);\r\n\t\tif(link.indexOf('?') != -1)\r\n\t\t{\r\n\t\t\treturn link + '&' + name + '=' + value;\r\n\t\t}\r\n\t\treturn link + '?' + name + '=' + value;\r\n\t}\r\n}","class Pool\r\n{\r\n    constructor()\r\n    {\r\n        this.pool = {};\r\n    }\r\n\r\n    add(cmd, index, fields)\r\n    {\r\n        if (!this.pool.hasOwnProperty(index))\r\n        {\r\n            this.pool[index] = [];\r\n        }\r\n\r\n        this.pool[index].push({\r\n            [cmd]: {fields}\r\n        });\r\n    }\r\n\r\n    get()\r\n    {\r\n        return this.pool;\r\n    }\r\n\r\n    clean()\r\n    {\r\n        this.pool = {};\r\n    }\r\n\r\n    isEmpty()\r\n    {\r\n        return Object.keys(this.pool).length === 0;\r\n    }\r\n}\r\n\r\nexport {\r\n    Pool\r\n}","class Timer\n{\n\tconstructor()\n\t{\n\t\tthis.list = [];\n\t}\n\n\tadd(fields)\n\t{\n\t\tif (!fields.hasOwnProperty('index'))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.list[fields.index] = {\n\t\t\tid: fields.id\n\t\t};\n\t}\n\n\tget(index)\n\t{\n\t\tif (!this.list[index] || this.list[index].length <= 0)\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\treturn this.list[index];\n\t}\n\n\tdelete(fields)\n\t{\n\t\tthis.list.splice(fields.index, 1);\n\t}\n\n\tclean(fields)\n\t{\n\t\tlet timer = this.get(fields.index);\n\n\t\tclearTimeout(timer.id);\n\n\t\tthis.delete({\n\t\t\tindex: fields.index\n\t\t});\n\t}\n\n\tcreate(time, index = 'default', callback = null, callbackParams)\n\t{\n\t\tthis.clean({index});\n\n\t\tindex = index == null? 'default': index;\n\t\tcallback = typeof callback === 'function'? callback: function() {}\n\n\t\tlet timer = setTimeout(callback, time);\n\n\t\tlet item = {id: timer, index: index};\n\n\t\tthis.add(item)\n\t}\n\n\tisEmpty()\n\t{\n\t\treturn this.list.length === 0;\n\t}\n}\n\nexport {Timer}","class Basket\n{\n\tstatic toFixed(quantity, measureRatio, availableQuantity = 0)\n\t{\n\t\tlet precisionFactor =  Math.pow(10, 6);\n\t\tlet reminder = (quantity / measureRatio - ((quantity / measureRatio).toFixed(0))).toFixed(5),\n\t\t\tremain;\n\n\n\n\t\tif (parseFloat(reminder) === 0)\n\t\t{\n\t\t\treturn quantity;\n\t\t}\n\t\t\n\t\tif (measureRatio !== 0 && measureRatio !== 1)\n\t\t{\n\t\t\tremain = (quantity * precisionFactor) % (measureRatio * precisionFactor) / precisionFactor;\n\n\t\t\tif (measureRatio > 0 && remain > 0)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tremain >= measureRatio / 2\n\t\t\t\t\t&& (\n\t\t\t\t\t\tavailableQuantity === 0\n\t\t\t\t\t\t|| (quantity + measureRatio - remain) <= availableQuantity\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tquantity += (measureRatio * precisionFactor - remain * precisionFactor) / precisionFactor;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tquantity = (quantity * precisionFactor -  remain * precisionFactor) / precisionFactor;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn quantity;\n\t}\n\n\t// isRatioFloat(value)\n\t// {\n\t// \treturn parseInt(value) !== parseFloat(value)\n\t// }\n\n\tstatic isValueFloat(value)\n\t{\n\t\treturn parseInt(value) !== parseFloat(value)\n\t}\n\n\tstatic roundValue(value)\n\t{\n\t\tif(Basket.isValueFloat(value))\n\t\t{\n\t\t\treturn Basket.roundFloatValue(value)\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn parseInt(value, 10)\n\t\t}\n\t}\n\n\tstatic roundFloatValue(value)\n\t{\n\t\tlet precision = 6;\n\t\tlet precisionFactor = Math.pow(10, precision);\n\n\t\treturn Math.round(parseFloat(value) * precisionFactor) / precisionFactor;\n\t}\n}\n\nexport {\n\tBasket\n}","import {Product as ProductConst} from \"sale.checkout.const\";\n\nclass Product\n{\n\tstatic isService(item)\n\t{\n\t\treturn item.product.type === ProductConst.type.service;\n\t}\n\n\tstatic isLimitedQuantity(item)\n\t{\n\t\treturn item.product.checkMaxQuantity === 'Y'\n\t}\n}\n\nexport {\n\tProduct\n}","import { Url } from './url'\r\n\r\nexport class History\r\n{\r\n    constructor(options)\r\n    {\r\n        this.location = options.location;\r\n        this.params = options.params;\r\n    }\r\n\r\n    build()\r\n    {\r\n        let path = this.location;\r\n        let params = this.params;\r\n\r\n        try\r\n        {\r\n            for (let name in params)\r\n            {\r\n                if (!params.hasOwnProperty(name))\r\n                {\r\n                    continue;\r\n                }\r\n                path = Url.addLinkParam(path, name, params[name]);\r\n            }\r\n        }\r\n        catch (e) {}\r\n\r\n        return path;\r\n    }\r\n\r\n    static pushState(location, params)\r\n    {\r\n        let url = new History({location, params})\r\n            .build();\r\n\r\n        window.history.pushState(null, null, url);\r\n\r\n        return url;\r\n    }\r\n}"],"names":["Url","window","location","protocol","hostname","port","pathname","search","link","name","value","length","Uri","removeParam","indexOf","Pool","pool","cmd","index","fields","hasOwnProperty","push","Object","keys","Timer","list","id","splice","timer","get","clearTimeout","time","callback","clean","setTimeout","item","add","Basket","quantity","measureRatio","availableQuantity","precisionFactor","Math","pow","reminder","toFixed","remain","parseFloat","parseInt","isValueFloat","roundFloatValue","precision","round","Product","product","type","ProductConst","service","checkMaxQuantity","History","options","params","path","addLinkParam","e","url","build","history","pushState"],"mappings":"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"}